CREATE DATABASE BOOTCAMP_EXERCISE1;

USE BOOTCAMP_EXERCISE1;

CREATE TABLE REGIONS (
	REGION_ID INT PRIMARY KEY,
	REGION_NAME VARCHAR(25)
);

CREATE TABLE COUNTRIES (
	COUNTRY_ID VARCHAR(2) PRIMARY KEY,
    COUNTRY_NAME VARCHAR(40),
    REGION_ID INT,
    FOREIGN KEY (REGION_ID) REFERENCES REGIONS(REGION_ID)
);

CREATE TABLE LOCATIONS (
	LOCATION_ID INT PRIMARY KEY,
    STREET_ADDRESS VARCHAR(25),
    POSTAL_CODE VARCHAR(12),
    CITY VARCHAR(30),
    STATE_PROVINCE VARCHAR(12),
    COUNTRY_ID VARCHAR(2),
    FOREIGN KEY (COUNTRY_ID) REFERENCES COUNTRIES(COUNTRY_ID)
);

CREATE TABLE DEPARTMENTS (
	DEPARTMENT_ID INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(30),
    MANAGER_ID INT,
    LOCATION_ID INT,
    FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS(LOCATION_ID)
);

CREATE TABLE JOBS (
	JOB_ID VARCHAR(10) PRIMARY KEY,
    JOB_TITLE VARCHAR(35),
    MIN_SALARY INT,
    MAX_SALARY INT
);

CREATE TABLE EMPLOYEES (
	EMPLOYEE_ID INT PRIMARY KEY,
    FIRST_NAME VARCHAR(20),
    LAST_NAME VARCHAR(25),
    EMAIL VARCHAR(25),
    PHONE_NUMBER VARCHAR(20),
    HIRE_DATE DATE,
    JOB_ID VARCHAR(20),
    SALARY INT,
    COMMISSION_PCT INT,
    MANAGER_ID INT,
    DEPARTMENT_ID INT,
    FOREIGN KEY (JOB_ID) REFERENCES JOBS(JOB_ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(DEPARTMENT_ID)
);

CREATE TABLE JOB_HISTORY (
	EMPLOYEE_ID INT,
    START_DATE DATE,
    END_DATE DATE,
    JOB_ID VARCHAR(20),
    DEPARTMENT_ID INT,
    PRIMARY KEY (EMPLOYEE_ID, START_DATE),
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES(EMPLOYEE_ID),
    FOREIGN KEY (JOB_ID) REFERENCES JOBS(JOB_ID),
    FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS(DEPARTMENT_ID)
);

INSERT INTO REGIONS (REGION_ID, REGION_NAME)
VALUES (1, 'EUROPE');
INSERT INTO REGIONS (REGION_ID, REGION_NAME)
VALUES (2, 'NORTH AMERICA');
INSERT INTO REGIONS (REGION_ID, REGION_NAME)
VALUES (3, 'ASIA');
INSERT INTO REGIONS (REGION_ID, REGION_NAME)
VALUES (4, 'OCEANIA');

SELECT * FROM REGIONS;

INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('DE', 'GERMANY', 1);
INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('IT', 'ITALY', 1);
INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('JP', 'JAPAN', 3);
INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('TW', 'TAIWAN', 3);
INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('US', 'UNITED STATES', 2);
INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
VALUES ('AU', 'AUSTRALIA', 4);

SELECT * FROM COUNTRIES;

INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1000, '1297 VIA COLA DI RIE', 989, 'ROMA', NULL, 'IT');
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1100, '93091 CALLE DELLA TE', 10934, 'VENICE', NULL, 'IT');
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1200, '2017 SHINJUKU-KU', 1689, 'TOKYO', 'TOKYO', 'JP');
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1300, '149 YUCHENG STREET', 115, 'TAIPEI', NULL, 'TW');
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1400, '2014 JABBERWOCKY RD', 26192, 'SOUTHLAKE', 'TEXAS', 'US');
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID)
VALUES (1500, '66 AUROLA LANE', 3008, 'MELBOURNE', 'VICTORIA', 'AU');

SELECT * FROM LOCATIONS;

INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (10, 'ADMINISTRATION', 200, 1100);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (20, 'MARKETING', 201, 1200);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (30, 'PURCHASING', 202, 1400);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (40, 'SALES', 203, 1500);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (50, 'ACCOUNTING', 204, 1000);
INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID)
VALUES (60, 'INFORMATION TECHNOLOGY', 205, 1300);

SELECT * FROM DEPARTMENTS;

INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('ST_CLERK', 'ADMINSTRATION CLERK', 10000, 30000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('MK_REP', 'MARKETING REPRESENTATIVE', 9000, 40000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('PU_AST', 'PURCHASING ASSISTANT', 8000, 35000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('SA_REP', 'SALES REPRESENTATIVE', 12000, 50000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('AC_CLERK', 'ACCOUNTING CLERK', 9000, 35000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('IT_PROG', 'IT PROGRAMMER', 11000, 45000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('ST_MGR', 'ADMINSTRATION MANAGER', 30000, 50000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('MK_MGR', 'MARKETING MANAGER', 40000, 60000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('PU_MGR', 'PURCHASING MANAGER', 35000, 55000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('SA_MGR', 'SALES MANAGER', 50000, 70000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('AC_MGR', 'ACCOUNTING MANAGER', 35000, 55000);
INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
VALUES ('IT_MGR', 'IT MANAGER', 45000, 65000);

SELECT * FROM JOBS;

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (100, 'STEVEN', 'KING', 'SKING', 5151234567, '1987-06-17', 'ST_CLERK', 24000, 0, 109, 10); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (101, 'NEENA', 'KOCHHAR', 'NKOCHHAR', 5151234568, '1987-06-18', 'MK_REP', 17000, 0, 103, 20); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (102, 'LEX', 'DE HAAN', 'LDEHAAN', 5151234569, '1987-06-19', 'IT_PROG', 17000, 0, 108, 60); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (103, 'ALEXANDER', 'HUNOLD', 'AHUNOLD', 5904234567, '1987-06-20', 'MK_REP', 29000, 0, 105, 20); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (104, 'ELODIE', 'DUBOIS', 'EDUBOIS', 333415656, '1987-06-21', 'ST_CLERK', 20000, 0, 109, 10); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (105, 'HARUTO', 'TANAKA', 'HTANAKA', 811461745, '1987-06-22', 'MK_REP', 34000, 0, 201, 20); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (106, 'EMILY', 'JOHNSON', 'EJOHNSON', 619841632, '1987-06-23', 'PU_AST', 22000, 0, 113, 30); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (107, 'MICHAEL', 'ANDERSON', 'MANDERSON', 17415628, '1987-06-24', 'AC_CLERK', 18000, 0, 119, 50); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (108, 'WEI MING', 'CHEN', 'WMCHEN', 8867848465, '1987-06-25', 'IT_PROG', 30000, 0, 112, 60); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (109, 'ALEJANDRO', 'GARCIA', 'AGARCIA', 347646186, '1987-06-26', 'ST_CLERK', 29000, 0, 200, 10); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (110, 'JI-WOO', 'KIM', 'JWKIM', 828897461, '1987-06-27', 'SA_REP', 41000, 15, 114, 40); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (111, 'JUAN', 'SANTOS', 'JSANTOS', 637481625, '1987-06-28', 'AC_CLERK', 10000, 0, 107, 50); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (112, 'ARJUN', 'SHARMA', 'ASHARMA', 916128941, '1987-06-29', 'IT_PROG', 42000, 0, 205, 60); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (113, 'KA LEUNG', 'WONG', 'KLWONG', 8523681516, '1987-06-30', 'PU_AST', 33000, 0, 202, 30); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (114, 'WEI-JIE', 'TAN', 'WJTAN', 659181638, '1987-07-01', 'SA_REP', 45000, 20, 203, 40); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (115, 'MINH', 'NGUYEN', 'MNGUYEN', 841568166, '1987-07-02', 'PU_AST', 15000, 0, 113, 30); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (116, 'JAMES', 'WILSON', 'JWILSON', 449945154, '1987-07-03', 'IT_PROG', 23000, 0, 108, 60); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (117, 'MARIA', 'HERNANDEZ', 'MHERNANDEZ', 529846148, '1987-07-04', 'SA_REP', 17000, 10, 110, 40); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (118, 'LUKAS', 'BAUER', 'LBAUER', 437461825, '1987-07-05', 'ST_CLERK', 30000, 0, 200, 10); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (119, 'LEAH', 'COHEN', 'LCOHEN', 9726512547, '1987-07-06', 'AC_CLERK', 28000, 0, 204, 50); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (120, 'AMIR', 'REZA', 'AREZA', 985464132, '1987-07-07', 'IT_PROG', 40000, 0, 205, 60); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (200, 'ERIK', 'JOHANSSON', 'EJOHANSSON', 468618681, '1987-06-16', 'ST_MGR', 45000, 0, NULL, 10); 
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (201, 'LUCIA', 'FERNANDEZ', 'LFERNANDEZ', 517484185, '1987-06-16', 'MK_MGR', 42000, 0, NULL, 20);
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (202, 'KRZYSZTOF', 'NOWAK', 'KNOWAK', 488415617, '1987-06-16', 'PU_MGR', 40000, 0, NULL, 30);
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (203, 'MEHMET', 'YILMAZ', 'MYILMAZ', 901156812, '1987-06-16', 'SA_MGR', 54000, 25, NULL, 40);
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (204, 'JOAO', 'SILVA', 'JSILVA', 3518964916, '1987-06-16', 'AC_MGR', 46000, 0, NULL, 50);
INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSION_PCT, MANAGER_ID, DEPARTMENT_ID)
VALUES (205, 'RYAN', 'CLARK', 'RCLARK', 19841618, '1987-06-16', 'IT_MGR', 55000, 0, NULL, 60);

SELECT * FROM EMPLOYEES;

INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (102, '1993-01-13', '1998-07-24', 'IT_PROG', 20);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (101, '1989-09-21', '1993-10-27', 'MK_REP', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (101, '1993-10-28', '1997-03-15', 'MK_REP', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (100, '1996-02-17', '1999-12-19', 'ST_CLERK', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (103, '1998-03-24', '1999-12-31', 'MK_REP', 20);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (100, '2000-01-22', '2003-07-01', 'ST_CLERK', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (102, '1998-10-01', '2005-04-20', 'IT_PROG', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (104, '1994-05-17', '1996-12-25', 'ST_CLERK', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (106, '1992-03-25', '1995-09-14', 'PU_AST', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (105, '1988-08-31', '1994-02-24', 'MK_REP', 20);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (105, '1994-11-18', '1996-10-12', 'MK_REP', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (107, '1990-01-08', '1993-11-18', 'AC_CLERK', 50);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (107, '1994-02-14', '1998-04-11', 'AC_CLERK', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (108, '1990-04-07', '1995-05-29', 'IT_PROG', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (110, '1987-09-02', '1992-05-04', 'SA_REP', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (108, '1995-06-01', '2000-12-31', 'IT_PROG', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (109, '1993-01-12', '1997-06-30', 'ST_CLERK', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (109, '1997-07-01', '2003-03-06', 'ST_CLERK', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (111, '1988-08-18', '1991-02-04', 'AC_CLERK', 50);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (112, '1989-05-21', '1992-10-18', 'IT_PROG', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (111, '1993-08-18', '1995-10-11', 'AC_CLERK', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (112, '1992-11-02', '1995-07-15', 'IT_PROG', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (113, '1996-04-10', '1999-08-21', 'PU_AST', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (114, '1988-01-07', '1994-11-03', 'SA_REP', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (115, '1997-09-14', '1999-01-29', 'PU_AST', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (115, '1999-02-01', '2002-04-12', 'PU_AST', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (116, '1997-03-24', '2001-09-27', 'IT_PROG', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (116, '2001-10-05', '2005-02-28', 'IT_PROG', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (117, '1990-07-11', '1993-10-14', 'SA_REP', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (118, '1991-05-19', '1997-05-30', 'ST_CLERK', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (117, '1993-11-06', '1996-02-13', 'SA_REP', 20);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (117, '1996-02-18', '1998-12-05', 'SA_REP', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (118, '1997-08-15', '2000-03-31', 'ST_CLERK', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (119, '1994-07-16', '1999-06-04', 'AC_CLERK', 50);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (120, '1990-06-20', '1995-11-11', 'IT_PROG', 60);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (120, '1995-12-03', '1998-10-17', 'IT_PROG', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (120, '1998-12-21', '2004-07-19', 'IT_PROG', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (200, '1987-06-16', '2005-12-31', 'ST_MGR', 10);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (201, '1987-06-16', '2005-12-31', 'MK_MGR', 20);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (202, '1987-06-16', '2005-12-31', 'PU_MGR', 30);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (203, '1987-06-16', '2005-12-31', 'SA_MGR', 40);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (204, '1987-06-16', '2005-12-31', 'AC_MGR', 50);
INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
VALUES (205, '1987-06-16', '2005-12-31', 'IT_MGR', 60);

SELECT * FROM JOB_HISTORY;

-- 3
SELECT LOCATION_ID, STREET_ADDRESS, CITY, STATE_PROVINCE, COUNTRY_NAME
FROM LOCATIONS L LEFT JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID;

-- 4
SELECT FIRST_NAME, LAST_NAME, DEPARTMENT_ID
FROM EMPLOYEES;

-- 5
WITH LOCATION_SUMMARY AS (
SELECT D.DEPARTMENT_ID, D.LOCATION_ID, L.COUNTRY_ID
FROM DEPARTMENTS D LEFT JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID),
JOB_SUMMARY AS (
SELECT J.EMPLOYEE_ID, E.FIRST_NAME, E.LAST_NAME, J.JOB_ID, J.DEPARTMENT_ID
FROM JOB_HISTORY J LEFT JOIN EMPLOYEES E ON J.EMPLOYEE_ID = E.EMPLOYEE_ID)
SELECT FIRST_NAME, LAST_NAME, JOB_ID, JO.DEPARTMENT_ID 
FROM JOB_SUMMARY JO LEFT JOIN LOCATION_SUMMARY LO ON JO.DEPARTMENT_ID = LO.DEPARTMENT_ID
WHERE COUNTRY_ID = 'JP';

-- 6
SELECT E1.EMPLOYEE_ID, E1.LAST_NAME, E1.MANAGER_ID, E2.LAST_NAME
FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.MANAGER_ID = E2.EMPLOYEE_ID;

-- 7
SELECT FIRST_NAME, LAST_NAME, HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE > (SELECT HIRE_DATE FROM EMPLOYEES WHERE CONCAT(FIRST_NAME, ' ', LAST_NAME) = 'LEX DE HAAN');

-- 8
SELECT D.DEPARTMENT_NAME, COUNT(1)
FROM EMPLOYEES E LEFT JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY E.DEPARTMENT_ID;

-- 9
SELECT JH.EMPLOYEE_ID, JO.JOB_TITLE, DATEDIFF(END_DATE, START_DATE) AS NUMBER_OF_DAYS
FROM JOB_HISTORY JH LEFT JOIN JOBS JO ON JH.JOB_ID = JO.JOB_ID
WHERE JH.DEPARTMENT_ID = 30;

-- 10
WITH MGR_NAME AS (
SELECT D.*, CONCAT(E.FIRST_NAME, ' ', E.LAST_NAME) AS MANAGER_NAME
FROM DEPARTMENTS D LEFT JOIN EMPLOYEES E ON D.MANAGER_ID = E.EMPLOYEE_ID),
COUNTRY_NAME AS (
SELECT L.*, C.COUNTRY_NAME
FROM LOCATIONS L LEFT JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID)
SELECT DEPARTMENT_NAME, MANAGER_NAME, CITY, COUNTRY_NAME
FROM MGR_NAME M LEFT JOIN COUNTRY_NAME C ON M.LOCATION_ID = C.LOCATION_ID;

-- 11
SELECT E.DEPARTMENT_ID, D.DEPARTMENT_NAME, AVG(SALARY)
FROM EMPLOYEES E LEFT JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
GROUP BY DEPARTMENT_ID
ORDER BY DEPARTMENT_ID;

-- 12
-- Remove Min_Salary and Max_Salary from the 'Jobs' table and place them in a separate table 'Job_Grades'.
-- Add a column 'Grade_Level' in 'Jobs' as a foreign key to link it to 'Job_Grades'.